# Test info

- Name: Visit Swagger Petstore >> Visit endpoint
- Location: /home/runner/work/mokapi/mokapi/webui/e2e/Dashboard/http.spec.ts:64:9

# Error details

```
Error: Timed out 5000ms waiting for expect(locator).toContainText(expected)

Locator: locator('main').getByTestId('http-operation').getByTestId('http-request').getByRole('dialog', { name: 'Data Validator' }).getByRole('region', { name: 'Source' }).getByRole('region', { name: 'Content' })
Expected string: "\"id\":"
Received string: "123456789101112{  \"category\": {    \"name\": \"hedgehog\"  },  \"photoUrls\": [    \"http://www.seniorbleeding-edge.io/schemas/monetize/supply-chains\",    \"http://www.centralmindshare.info/target/incubate/killer/implement\",    \"http://www.humanenterprise.name/aggregate/visionary/generate/interfaces\",    \"https://www.globalsticky.name/clicks-and-mortar/vertical/syndicate/open-source\",    \"https://www.directschemas.biz/experiences/visionary/supply-chains\"  ]}  ההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"
Call log:
  - expect.toContainText with timeout 5000ms
  - waiting for locator('main').getByTestId('http-operation').getByTestId('http-request').getByRole('dialog', { name: 'Data Validator' }).getByRole('region', { name: 'Source' }).getByRole('region', { name: 'Content' })
    9 × locator resolved to <section data-v-4320bd73="" class="source json" aria-label="Content">…</section>
      - unexpected value "123456789101112{  "category": {    "name": "hedgehog"  },  "photoUrls": [    "http://www.seniorbleeding-edge.io/schemas/monetize/supply-chains",    "http://www.centralmindshare.info/target/incubate/killer/implement",    "http://www.humanenterprise.name/aggregate/visionary/generate/interfaces",    "https://www.globalsticky.name/clicks-and-mortar/vertical/syndicate/open-source",    "https://www.directschemas.biz/experiences/visionary/supply-chains"  ]}  ההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההההXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"

    at /home/runner/work/mokapi/mokapi/webui/e2e/Dashboard/http.spec.ts:118:52
    at /home/runner/work/mokapi/mokapi/webui/e2e/Dashboard/http.spec.ts:113:21
    at /home/runner/work/mokapi/mokapi/webui/e2e/Dashboard/http.spec.ts:98:17
    at /home/runner/work/mokapi/mokapi/webui/e2e/Dashboard/http.spec.ts:86:13
    at /home/runner/work/mokapi/mokapi/webui/e2e/Dashboard/http.spec.ts:69:9
```

# Page snapshot

```yaml
- banner:
  - navigation:
    - link "Mokapi home":
      - /url: ./
      - img "Mokapi home"
    - list:
      - listitem:
        - link "Dashboard":
          - /url: /dashboard?refresh=20
      - listitem:
        - link "Guides":
          - /url: /docs/guides
      - listitem:
        - link "Configuration":
          - /url: /docs/configuration
      - listitem:
        - link "JavaScript API":
          - /url: /docs/javascript-api
      - listitem:
        - link "Resources":
          - /url: /docs/resources
      - listitem:
        - link "Blogs":
          - /url: /docs/blogs
      - listitem:
        - link "References":
          - /url: /docs/references
    - link "Version 0.11.0":
      - /url: https://github.com/marle3003/mokapi
    - text: 
- main:
  - heading "Dashboard" [level=1]
  - navigation "Services":
    - list:
      - listitem:
        - link "Overview":
          - /url: /dashboard
      - listitem:
        - link "HTTP":
          - /url: /dashboard/http
      - listitem:
        - link "Kafka":
          - /url: /dashboard/kafka
      - listitem:
        - link "SMTP":
          - /url: /dashboard/smtp
      - listitem:
        - link "LDAP":
          - /url: /dashboard/ldap
      - listitem:
        - link "Configs":
          - /url: /dashboard/configs
      - listitem:
        - link "Faker":
          - /url: /dashboard/tree
  - paragraph: Operation
  - paragraph:
    - text:  POST
    - link "/pet":
      - /url: /dashboard/http/services/Swagger%20Petstore/pet
  - paragraph: Operation ID
  - paragraph: addPet
  - paragraph: Service
  - paragraph:
    - link "Swagger Petstore":
      - /url: /dashboard/http/services/Swagger%20Petstore
  - paragraph: Warning
  - paragraph: Deprecated
  - text: HTTP
  - paragraph: Summary
  - paragraph: Add a new pet to the store
  - text: Request
  - tablist:
    - tab " Body" [selected]
    - tab " Parameters"
    - tab " Security"
  - tabpanel " Body":
    - paragraph: Description
    - paragraph: Create a new pet in the store
    - paragraph: Required
    - region "Source":
      - text: 76 lines · 1.34 kB
      - button "Copy raw content": 
      - button "Download raw content": 
      - region "Content":
        - textbox "Cursor at row 1"
        - text: "{ \"type\": [ \"object\" ], \"properties\": { \"name\": { \"type\": \"string\", \"example\": \"doggie\" }, \"photoUrls\": { \"type\": \"array\", \"items\": { \"type\": \"string\" }, \"xml\": {"
    - button "Expand"
    - button "Example & Validate"
    - dialog "Data Validator":
      - heading "Data Validator" [level=6]
      - button "Close"
      - region "Source":
        - text: application/json · 12 lines · 450 B
        - button "Copy raw content": 
        - button "Download raw content": 
        - region "Content":
          - textbox "Cursor at row 12"
          - text: "{ \"category\": { \"name\": \"hedgehog\" }, \"photoUrls\": [ \"http://www.seniorbleeding-edge.io/schemas/monetize/supply-chains\", \"http://www.centralmindshare.info/target/incubate/killer/implement\", \"http://www.humanenterprise.name/aggregate/visionary/generate/interfaces\", \"https://www.globalsticky.name/clicks-and-mortar/vertical/syndicate/open-source\", \"https://www.directschemas.biz/experiences/visionary/supply-chains\" ] }"
      - status
      - button "Example"
      - button "Validate"
    - combobox "Request content type":
      - option "application/json" [selected]
      - option "application/xml"
      - option "application/yaml"
  - text: Response
  - tablist:
    - tab "200 OK" [selected]
    - tab "400 Bad Request"
  - tabpanel "200 OK":
    - paragraph: Description
    - paragraph:
      - paragraph: Successful operation
    - list:
      - tab "Body" [selected]
      - tab "| Headers"
    - tabpanel "Body":
      - region "Source":
        - text: 76 lines · 1.34 kB
        - button "Copy raw content": 
        - button "Download raw content": 
        - region "Content":
          - textbox "Cursor at row 1"
          - text: "{ \"type\": [ \"object\" ], \"properties\": { \"id\": { \"type\": \"integer\", \"format\": \"int64\" }, \"category\": { \"ref\": \"#/components/schemas/Category\", \"type\": \"object\", \"properties\": { \"id\": { \"type\": \"integer\","
      - button "Expand"
      - button "Example & Validate"
      - combobox "Response content type":
        - option "application/json" [selected]
  - text: Recent Requests
  - table:
    - rowgroup:
      - row "Method URL Status Code Time Duration":
        - columnheader
        - columnheader "Method"
        - columnheader "URL"
        - columnheader "Status Code"
        - columnheader "Time"
        - columnheader "Duration"
    - rowgroup:
      - row " POST http://127.0.0.1:18080/pet 200 OK 2023-02-13 07:49:25 30 [sec]":
        - cell ""
        - cell "POST"
        - cell "http://127.0.0.1:18080/pet"
        - cell "200 OK"
        - cell "2023-02-13 07:49:25"
        - cell "30 [sec]"
      - row "POST http://127.0.0.1:18080/pet 500 Internal Server Error 2023-02-13 09:05:25 133 [ms]":
        - cell
        - cell "POST"
        - cell "http://127.0.0.1:18080/pet"
        - cell "500 Internal Server Error"
        - cell "2023-02-13 09:05:25"
        - cell "133 [ms]"
```

# Test source

```ts
   18 |
   19 |     test('Visit overview', async ({ dashboard }) => {
   20 |         await dashboard.open()
   21 |         const http = dashboard.http
   22 |         await http.clickService('Swagger Petstore')
   23 |
   24 |         // service info
   25 |         await expect(http.serviceInfo.name).toHaveText('Swagger Petstore')
   26 |         await expect(http.serviceInfo.version).toHaveText('1.0.6')
   27 |         await expect(http.serviceInfo.contact).toHaveText('Swagger Petstore Team')
   28 |         await expect(http.serviceInfo.mail).toHaveAttribute('href', 'mailto:petstore@petstore.com')
   29 |         await expect(http.serviceInfo.description).toHaveText('This is a sample server Petstore server. You can find out more about at http://swagger.io')
   30 |
   31 |         // servers
   32 |         const server = http.servers.getByRole('cell')
   33 |         await expect(server.nth(0)).toHaveText('http://localhost:8080')
   34 |         await expect(server.nth(1)).toHaveText('Server is mocked by mokapi')
   35 |
   36 |         // endpoints
   37 |         const endpoints = http.endpoints.locator('tbody tr')
   38 |         for (const [i, path] of service.paths.entries()) {
   39 |             const cells = endpoints.nth(i).getByRole('cell')
   40 |             await expect(cells.nth(0)).toHaveText(path.path)
   41 |             await expect(cells.nth(1)).toHaveText(path.summary)
   42 |             await expect(cells.nth(2)).toHaveText(path.method, {ignoreCase: false})
   43 |             await expect(cells.nth(3)).toHaveText(path.lastRequest)
   44 |             await expect(cells.nth(4)).toHaveText(path.requests)
   45 |         }
   46 |
   47 |         // requests
   48 |         const requests = http.requests.locator('tbody tr')
   49 |         for (const [i, request] of service.requests.entries()) {
   50 |             const cells = requests.nth(i).getByRole('cell')
   51 |             if (request.deprecated) {
   52 |                 await expect(cells.nth(0).locator('.warning')).toBeVisible()
   53 |             } else {
   54 |                 await expect(cells.nth(0).locator('.warning')).not.toBeVisible()
   55 |             }
   56 |             await expect(cells.nth(1)).toHaveText(request.method)
   57 |             await expect(cells.nth(2)).toHaveText(request.url)
   58 |             await expect(cells.nth(3)).toHaveText(request.statusCode)
   59 |             await expect(cells.nth(4)).toHaveText(request.time)
   60 |             await expect(cells.nth(5)).toHaveText(request.duration)
   61 |         }
   62 |     })
   63 |
   64 |     test('Visit endpoint', async ({ dashboard, page }) => {
   65 |         await dashboard.open()
   66 |         const http = dashboard.http
   67 |         await http.clickService('Swagger Petstore')
   68 |
   69 |         await test.step('/pet', async () => {
   70 |             await http.clickPath('/pet')
   71 |             const path = http.getPathModel()
   72 |             await expect(path.path).toHaveText('/pet')
   73 |             await expect(path.service).toHaveText('Swagger Petstore')
   74 |             await expect(path.type).toHaveText('HTTP')
   75 |
   76 |             const cells = path.methods.locator('tbody tr').nth(0).getByRole('cell')
   77 |             await expect(cells.nth(0)).toHaveText('POST', {ignoreCase: false})
   78 |             await expect(cells.nth(0).locator('span')).toHaveClass('badge operation post')
   79 |             await expect(cells.nth(1)).toHaveText('Add a new pet to the store')
   80 |             await expect(cells.nth(2)).toHaveText('addPet')
   81 |
   82 |             const rows = path.requests.locator('tbody tr')
   83 |             await expect(rows).toHaveCount(2)
   84 |             await expect(rows.getByRole('cell').nth(2)).toHaveText(service.requests[0].url)
   85 |
   86 |             await test.step('visit method post', async () => {
   87 |                 await path.clickOperation('POST')
   88 |                 const op = http.getOperationModel()
   89 |
   90 |                 await expect(op.operation).toHaveText('POST', {ignoreCase: false})
   91 |                 await expect(op.path).toHaveText('/pet')
   92 |                 await expect(op.operationId).toHaveText('addPet')
   93 |                 await expect(op.service).toHaveText('Swagger Petstore')
   94 |                 await expect(op.type).toHaveText('HTTP')
   95 |                 await expect(op.summary).toHaveText('Add a new pet to the store')
   96 |                 await expect(op.description).not.toBeVisible()
   97 |
   98 |                 await test.step("http request", async () => {
   99 |                     await expect(op.request.tabs.locator('.active')).toHaveText('Body')
  100 |                     await expect(op.request.body).not.toHaveText('')
  101 |
  102 |                     await test.step('click expand', async () => {
  103 |                         const expand = op.request.expand
  104 |                         await expand.button.click()
  105 |                         await expect(expand.code).toBeVisible()
  106 |                         await expect(expand.code).not.toHaveText('')
  107 |                         await expand.code.press('Escape', { delay: 500 })
  108 |                         // without a second time, dialog does not disappear
  109 |                         await page.locator('body').press('Escape')
  110 |                         await expect(expand.code).not.toBeVisible()
  111 |                     })
  112 |
  113 |                     await test.step('click example', async () => {
  114 |                         const example = op.request.example
  115 |                         await example.button.click()
  116 |                         await example.example.click()
  117 |                         await expect(example.code).toBeVisible()
> 118 |                         await expect(example.code).toContainText(`"id":`)
      |                                                    ^ Error: Timed out 5000ms waiting for expect(locator).toContainText(expected)
  119 |                         await op.request.example.code.press('Escape', { delay: 500 })
  120 |                         // without a second time, dialog does not disappear
  121 |                         await page.locator('body').press('Escape')
  122 |                         await expect(example.code).not.toBeVisible()
  123 |                     })
  124 |                 })
  125 |
  126 |                 await test.step("http response", async () => {
  127 |                     await expect(op.response.element.getByRole('tab', {name: '200 OK'})).toBeVisible()
  128 |                     await expect(op.response.element.getByTestId('response-description-200')).toHaveText('Successful operation')
  129 |
  130 |                     await op.response.element.getByRole('tab', {name: '400 Bad Request'}).click()
  131 |                     await expect(op.response.element.getByTestId('response-description-400')).toHaveText('Invalid ID supplied')
  132 |
  133 |                     await expect(op.response.element.getByRole('tab', {name: 'Body'})).toHaveClass(/disabled/)
  134 |                     await expect(op.response.element.getByRole('tab', {name: 'Headers'})).not.toHaveClass(/disabled/)
  135 |
  136 |                     const cells = op.response.element.locator('tbody tr').nth(0).getByRole('cell')
  137 |                     await expect(cells.nth(0)).toHaveText('petId')
  138 |                     await expect(cells.nth(1)).toHaveText('number')
  139 |                     await expect(cells.nth(2)).toHaveText('Status values that need to be considered for filter')
  140 |
  141 |                     await cells.nth(0).click()
  142 |                     const dialog = page.locator('#modal-petId')
  143 |                     await expect(dialog).toBeVisible()
  144 |                     await dialog.press('Escape', { delay: 500 })
  145 |                      // without a second time, dialog does not disappear
  146 |                      await dialog.press('Escape')
  147 |                      await expect(dialog).not.toBeVisible()
  148 |                 })
  149 |
  150 |                 await test.step("visit GET /pet/findByStatus", async () => {
  151 |                     await op.service.click()
  152 |
  153 |                     await test.step('click on GET of path',async () => {
  154 |                         await dashboard.http.endpoints.getByRole('row', { name: '/pet/findByStatus' }).getByText('get').click()
  155 |                     })
  156 |                     
  157 |                     await test.step('switch response contenttype',async () => {
  158 |                         await page.getByRole('combobox', { name: 'Response content type' }).selectOption('application/xml')
  159 |
  160 |                         await expect(page.getByLabel('OK').getByLabel('Response content type')).toHaveValue('application/xml')
  161 |                     })
  162 |
  163 |                     await test.step('click on HTTP status 500',async () => {
  164 |                         await page.getByRole('tab', { name: '500 Internal Server Error' }).click()
  165 |                         const tab = page.getByRole('tabpanel', { name: '500 Internal Server Error' })
  166 |                         await expect(tab.getByLabel('Response body description')).toHaveText('server error')
  167 |                     })
  168 |                 })
  169 |             })
  170 |         })
  171 |     })
  172 | })
```